<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
		<style type="text/css">
			html { height: 100% }
			body { height: 100%; margin: 10; padding: 10 }	
			#map_canvas { height: 100% }
		</style>
		<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?sensor=false"></script>
		
		<script type="text/javascript">

		  var gmarkers = [];  //uno para todos para calcular en convexhull
    	var points = [];
    	var hullPoints = [];
    	var map = null;
    	var polyline;
	//var puntosrandom = document.getElementById("end").value ;
     	//var puntosrandom = 30;   //aqui se cambia de 10 hasta 1000 puntos


    	var infowindow = new google.maps.InfoWindow({   //informacion de cada marker persona o lugar
        	size: new google.maps.Size(250,150)
     	});
		
	function initialize() {
  		  directionsService = new google.maps.DirectionsService();
			  directionsRenderer = new google.maps.DirectionsRenderer();
	var puntosrandom = document.getElementById("end").value ;		  
        var myOptions = {
    			zoom: 16,
    			center: new google.maps.LatLng(-16.409081,-71.537476),
    			mapTypeControl: true,
    			mapTypeControlOptions: {style: google.maps.MapTypeControlStyle.DROPDOWN_MENU},
    			navigationControl: true,
    			mapTypeId: google.maps.MapTypeId.ROADMAP
  		  }
  		  
        map = new google.maps.Map(document.getElementById("map_canvas"),myOptions);
  			directionsRenderer.setMap(map);
	   		
        google.maps.event.addListener(map, 'click', function(event) {
		addWayPointToRoute(event.latLng);
    	});

	google.maps.event.addListener(map, 'click', function() {
        	infowindow.close();
 	});
 
 	google.maps.event.addListenerOnce(map, 'bounds_changed', function() {

	     	var bounds = map.getBounds();
	     	var southWest = bounds.getSouthWest();
	     	var northEast = bounds.getNorthEast();
	     	var lngSpan = northEast.lng() - southWest.lng();
	     	var latSpan = northEast.lat() - southWest.lat();
		map.setCenter(map.getCenter());
	     	map.setZoom(map.getZoom()-1);
     	
		for (var i = 0; i < puntosrandom ; i++) {  
	       	  	var point = new google.maps.LatLng(southWest.lat() + latSpan * Math.random(),
		           southWest.lng() + lngSpan * Math.random());
	       		 points.push(point);
		       	 var marker = createMarker(point, i);
		       	 gmarkers.push(marker);
		}

	      	for (var i=0; i < points.length; i++) {
		  	document.getElementById("input_points").innerHTML += i+": "+points[i].toUrlValue()+"<br>";
	      	}
   
    	  });
	}

        function createMarker(latlng, marker_number) {
          var html = "Persona "+marker_number;
          var marker = new google.maps.Marker({
            position: latlng,
            map: map,
            zIndex: Math.round(latlng.lat()*-100000)<<5
          });

          google.maps.event.addListener(marker, 'click', function() {
            var contentString = html + "<br>"+marker.getPosition().toUrlValue()+"<br><a href='javascript:removeMarker(new google.maps.LatLng("+marker.getPosition().toUrlValue()+"));'>Borrar Persona</a>";
            infowindow.setContent(contentString); 
            infowindow.open(map,marker);
          });
          return marker;
        }
 

		</script>
	</head>

	<body onload="initialize()">
		<p>UCSP - EDA </p>
		<div id="tools">
			<input type="text" name="end" id="end" value=""/>
			<input type="submit" onclick="initialize();"/>

		</div>
		<table border="0">
             <tr><td valign="top">
        		<div id="map_canvas" style="width: 1250px; height: 600px"></div>
        		<table border="1" width="100%">
          			<tr><th>Personas</th></tr>
          			<tr><td valign="top">
            			<div id="input_points"></div>
            		</td>
            		</tr>
        		</table>
    		</td></tr>
        </table>

		<div id="map_canvas" style="width:100%; height:100%"></div>
		<script src="http://www.google-analytics.com/urchin.js" type="text/javascript"></script>
		<script type="text/javascript">_uacct = "UA-162157-1";urchinTracker();</script>
	</body>
</html>
